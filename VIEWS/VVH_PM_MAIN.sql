--------------------------------------------------------
--  DDL for View VVH_PM_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE VIEW "VVH_PM_MAIN" ("ID", "HEAT_ID", "PLANT_UNIT_NO", "CV_PRACTICE", "ACT_PHASE", "STEEL_GRADE", "LADLE_ID", "DEGASSING_TIME", "SHIFT", "S_HEAT_ID", "TREAT_NO", "C_HEAT_STATUS_ID", "C_PLANT_UNIT_ID", "START_TIME", "END_TIME", "CV_PRACTICE_ID", "AIM_TEMP", "PHASE_SEQ_NO_CURR", "C_PHASE_ID", "C_STEEL_GRADE_ID", "C_EQUIPMENT_ID_LADLE", "LADLE_POS", "VACUUM_TIME", "ARRIVAL", "ARRIVAL_TEMP", "DEPARTURE", "DEPARTURE_TEMP", "PUMP_DOWN_TIME", "DEGASS_START_TIME", "BREAK_VACUUM_TIME", "RETURN_HEAT_ID", "RETURN_WEIGHT", "STEEL_WEIGHT", "SLAG_WEIGHT", "STEEL_TEMPERATURE", "VERIFIED", "VER_COMMENT", "LADLE_STATE", "AR_CONS", "N2_CONS", "MIN_VACCUM", "STEAM_TEMP", "STEAM_PRESS", "COND_INLET_TEMP", "COND_OUTLET_TEMP", "ONE_MBAR_TIME", "SECTION", "LADLE_LIFE", "PLUG_LIFE", "FREE_BOARD", "LIQUID_METAL", "TEMP_TIPS", "SAMPLER", "BVD_TEMP", "AVD_TEMP", "AVD_SH_TEMP", "OPERATION_MODE", "LIQUIDUS_TEMP", "CA_SI_WIRE_QUANTITY", "CA_FE_WIRE_QUANTITY", "S_WIRE_QUANTITY", "CA_SI_WIRE_TIME", "CA_FE_WIRE_TIME", "S_WIRE_TIME", "CREATED", "MODIFIED", "MOP", "ACT_PRESSURE", "TARGET_PRESSURE", "STIRRING", "ENERGY_LOSSES", "REMAINING_TIME") AS 
  SELECT "ID",
    (SELECT HEAT_NO FROM S_HEAT WHERE ID="S_HEAT_ID"
    ) AS HEAT_ID,
    (SELECT "PLANT_UNIT_NO" FROM C_PLANT_UNIT cpu WHERE cpu.ID=C_PLANT_UNIT_ID
    ) AS "PLANT_UNIT_NO",
    (SELECT PRACTICE_CODE FROM CV_PRACTICE CLP WHERE CLP.ID="CV_PRACTICE_ID"
    ) AS "CV_PRACTICE",
    (SELECT PHASE_TEXT_ENG FROM C_PHASE CP WHERE CP.ID="C_PHASE_ID"
    ) AS "ACT_PHASE",
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE CS WHERE CS.ID="C_STEEL_GRADE_ID"
    ) AS "STEEL_GRADE",
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL WHERE CL.ID="C_EQUIPMENT_ID_LADLE"
    ) AS "LADLE_ID",
     DECODE(END_TIME,null, sysdate, END_TIME) - DEGASS_START_TIME AS "DEGASSING_TIME",
    "SHIFT",
    "S_HEAT_ID",
    "TREAT_NO",
    "C_HEAT_STATUS_ID",
    "C_PLANT_UNIT_ID",
    "START_TIME",
    "END_TIME",
    "CV_PRACTICE_ID",
    "AIM_TEMP",
    "PHASE_SEQ_NO_CURR",
    "C_PHASE_ID",
    "C_STEEL_GRADE_ID",
    "C_EQUIPMENT_ID_LADLE",
    "LADLE_POS",
    "VACUUM_TIME",
    "ARRIVAL",
    "ARRIVAL_TEMP",
    "DEPARTURE",
    "DEPARTURE_TEMP",
    "PUMP_DOWN_TIME",
    "DEGASS_START_TIME",
    "BREAK_VACUUM_TIME",
    "RETURN_HEAT_ID",
    "RETURN_WEIGHT",
    "STEEL_WEIGHT",
    "SLAG_WEIGHT",
    "STEEL_TEMPERATURE",
    "VERIFIED",
    "VER_COMMENT",
    "LADLE_STATE",
    "AR_CONS",
    "N2_CONS",
    "MIN_VACCUM",
    "STEAM_TEMP",
    "STEAM_PRESS",
    "COND_INLET_TEMP",
    "COND_OUTLET_TEMP",
    "ONE_MBAR_TIME",
    "SECTION",
    "LADLE_LIFE",
    "PLUG_LIFE",
    "FREE_BOARD",
    "LIQUID_METAL",
    "TEMP_TIPS",
    "SAMPLER",
    "BVD_TEMP",
    "AVD_TEMP",
    "AVD_SH_TEMP",
    "OPERATION_MODE",
    "LIQUIDUS_TEMP",
    "CA_SI_WIRE_QUANTITY",
    "CA_FE_WIRE_QUANTITY",
    "S_WIRE_QUANTITY",
    "CA_SI_WIRE_TIME",
    "CA_FE_WIRE_TIME",
    "S_WIRE_TIME",
    "CREATED",
    "MODIFIED",
    "MOP",
    "ACT_PRESSURE",
    "TARGET_PRESSURE",
    0 AS "STIRRING",
    0 AS "ENERGY_LOSSES",
    0 as "REMAINING_TIME"
  FROM PV_HEAT
  WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(40);
