--------------------------------------------------------
--  DDL for View VLH_PM_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE VIEW "VLH_PM_MAIN" ("ID", "AR_CONS", "AR_FLOW", "AR_CONS2", "AR_FLOW2", "S_HEAT_ID", "HEAT_ID", "C_HEAT_STATUS_ID", "PLANT_UNIT_NO", "START_TIME", "REMAINING_TIME", "END_TIME", "CL_PRACTICE_ID", "CL_PRACTICE", "C_PHASE_ID", "C_STEEL_GRADE_ID", "STEEL_GRADE", "LADLE_ID", "STEEL_WEIGHT", "SLAG_WEIGHT", "STEEL_TEMPERATURE", "POWER_ON_TIME", "ENERGY_TOTAL", "SPEC_ENERGY", "ACT_TAP_NO", "ENERGY_LOSSES", "HEAT_NO_WAITING_P1", "STEEL_GRADE_WAITING_P1", "LADLE_NO_WAITING_P1", "STEEL_TEMPERATURE_WAITING_P1", "HEAT_NO_WAITING_P2", "STEEL_GRADE_WAITING_P2", "LADLE_NO_WAITING_P2", "STEEL_TEMPERATURE_WAITING_P2", "VOLTAGE_TAP_SETP", "STIRRING_SETP", "REMAIN_ENERGY_SETP") AS 
  SELECT "ID",AR_CONS, AR_FLOW, AR_CONS2, AR_FLOW2,
    "S_HEAT_ID" AS S_HEAT_ID,
    (SELECT HEAT_NO FROM S_HEAT WHERE ID="S_HEAT_ID"
    ) AS HEAT_ID,
    "C_HEAT_STATUS_ID",
    (SELECT "PLANT_UNIT_NO" FROM C_PLANT_UNIT cpu WHERE cpu.ID=C_PLANT_UNIT_ID
    ) AS "PLANT_UNIT_NO",
    "START_TIME",
    0 as "REMAINING_TIME",
    "END_TIME",
    "CL_PRACTICE_ID",
    (SELECT PRACTICE_CODE FROM CL_PRACTICE CLP WHERE CLP.ID="CL_PRACTICE_ID"
    ) AS "CL_PRACTICE",
    "C_PHASE_ID",
    C_STEEL_GRADE_ID,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE CS WHERE CS.ID="C_STEEL_GRADE_ID"
    ) AS "STEEL_GRADE",
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL WHERE CL.ID="C_EQUIPMENT_ID_LADLE"
    ) AS "LADLE_ID",
    "STEEL_WEIGHT",
    "SLAG_WEIGHT",
    (SELECT STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(30) AND pl.c_plant_unit_id=pl_heat.c_plant_unit_id)) AS STEEL_TEMPERATURE,
    "POWER_ON_TIME",
    "ENERGY_TOTAL",
    0  AS "SPEC_ENERGY",
    ACT_TAP_NO AS "ACT_TAP_NO",
    (SELECT ENERGY_LOSS_SUM FROM ML_HEAT mh where mh.pl_heat_id = PL_HEAT.ID) AS "ENERGY_LOSSES",
     (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND pl.c_plant_unit_id=pl_heat.c_plant_unit_id )) AS HEAT_NO_WAITING_P1,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND pl.c_plant_unit_id=pl_heat.c_plant_unit_id )) AS STEEL_GRADE_WAITING_P1,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND pl.c_plant_unit_id=pl_heat.c_plant_unit_id ) AS LADLE_NO_WAITING_P1,
    (SELECT STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND pl.c_plant_unit_id=pl_heat.c_plant_unit_id  )) AS STEEL_TEMPERATURE_WAITING_P1,
    (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND pl.c_plant_unit_id=pl_heat.c_plant_unit_id )) AS HEAT_NO_WAITING_P2,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT pl  WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND pl.c_plant_unit_id=pl_heat.c_plant_unit_id )) AS STEEL_GRADE_WAITING_P2,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND pl.c_plant_unit_id=pl_heat.c_plant_unit_id ) AS LADLE_NO_WAITING_P2,
    (SELECT ML_HEAT.STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND pl.c_plant_unit_id=pl_heat.c_plant_unit_id)) AS STEEL_TEMPERATURE_WAITING_P2,
    0 as VOLTAGE_TAP_SETP,
    0 as STIRRING_SETP,
    0 as REMAIN_ENERGY_SETP
  FROM PL_HEAT WHERE C_HEAT_STATUS_ID in (GET_HEAT_STATUS_ID(30))
   union
  SELECT 0 as "ID",null as AR_CONS, null as AR_FLOW, null as AR_CONS2, null as AR_FLOW2,
    null AS S_HEAT_ID,
    null AS HEAT_ID,
    0 "C_HEAT_STATUS_ID",
    1 "PLANT_UNIT_NO",
    null as "START_TIME",
    null as  "REMAINING_TIME",
    null as "END_TIME",
    null as "CL_PRACTICE_ID",
    null as  "CL_PRACTICE",
    null as "C_PHASE_ID",
    null as C_STEEL_GRADE_ID,
    null as  "STEEL_GRADE",
    null as  "LADLE_ID",
    null as "STEEL_WEIGHT",
    null as "SLAG_WEIGHT",
    null as "STEEL_TEMPERATURE",
    null as "POWER_ON_TIME",
    null as "ENERGY_TOTAL",
    null AS "SPEC_ENERGY",
    null AS "ACT_TAP_NO",
    null AS "ENERGY_LOSSES",
    (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND C_PLANT_UNIT_ID=5)) AS HEAT_NO_WAITING_P1,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31)  AND C_PLANT_UNIT_ID=5)) AS STEEL_GRADE_WAITING_P1,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31)  AND C_PLANT_UNIT_ID=5) AS LADLE_NO_WAITING_P1,
    (SELECT STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND C_PLANT_UNIT_ID=5)) AS STEEL_TEMPERATURE_WAITING_P1,
    (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32)  AND C_PLANT_UNIT_ID=5)) AS HEAT_NO_WAITING_P2,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND C_PLANT_UNIT_ID=5 )) AS STEEL_GRADE_WAITING_P2,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32)  AND C_PLANT_UNIT_ID=5) AS LADLE_NO_WAITING_P2,
    (SELECT ML_HEAT.STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND C_PLANT_UNIT_ID=5)) AS STEEL_TEMPERATURE_WAITING_P2,
    0 as VOLTAGE_TAP_SETP,
    0 as STIRRING_SETP,
    0 as REMAIN_ENERGY_SETP
  FROM DUAL
  union
  SELECT 0 as "ID",null as AR_CONS, null as AR_FLOW, null as AR_CONS2, null as AR_FLOW2,
    null AS S_HEAT_ID,
    null AS HEAT_ID,
    0 "C_HEAT_STATUS_ID",
    2 "PLANT_UNIT_NO",
    null as "START_TIME",
    null as  "REMAINING_TIME",
    null as "END_TIME",
    null as "CL_PRACTICE_ID",
    null as  "CL_PRACTICE",
    null as "C_PHASE_ID",
    null as C_STEEL_GRADE_ID,
    null as  "STEEL_GRADE",
    null as  "LADLE_ID",
    null as "STEEL_WEIGHT",
    null as "SLAG_WEIGHT",
    null as "STEEL_TEMPERATURE",
    null as "POWER_ON_TIME",
    null as "ENERGY_TOTAL",
    null AS "SPEC_ENERGY",
    null AS "ACT_TAP_NO",
    null AS "ENERGY_LOSSES",
    (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND C_PLANT_UNIT_ID=6)) AS HEAT_NO_WAITING_P1,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31)  AND C_PLANT_UNIT_ID=6)) AS STEEL_GRADE_WAITING_P1,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31)  AND C_PLANT_UNIT_ID=6) AS LADLE_NO_WAITING_P1,
    (SELECT STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND C_PLANT_UNIT_ID=6)) AS STEEL_TEMPERATURE_WAITING_P1,
    (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32)  AND C_PLANT_UNIT_ID=6)) AS HEAT_NO_WAITING_P2,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND C_PLANT_UNIT_ID=6 )) AS STEEL_GRADE_WAITING_P2,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32)  AND C_PLANT_UNIT_ID=6) AS LADLE_NO_WAITING_P2,
    (SELECT ML_HEAT.STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND C_PLANT_UNIT_ID=6)) AS STEEL_TEMPERATURE_WAITING_P2,
    0 as VOLTAGE_TAP_SETP,
    0 as STIRRING_SETP,
    0 as REMAIN_ENERGY_SETP
  FROM DUAL
  union
  SELECT 0 as "ID",null as AR_CONS, null as AR_FLOW, null as AR_CONS2, null as AR_FLOW2,
    null AS S_HEAT_ID,
    null AS HEAT_ID,
    0 "C_HEAT_STATUS_ID",
    3 "PLANT_UNIT_NO",
    null as "START_TIME",
    null as  "REMAINING_TIME",
    null as "END_TIME",
    null as "CL_PRACTICE_ID",
    null as  "CL_PRACTICE",
    null as "C_PHASE_ID",
    null as C_STEEL_GRADE_ID,
    null as  "STEEL_GRADE",
    null as  "LADLE_ID",
    null as "STEEL_WEIGHT",
    null as "SLAG_WEIGHT",
    null as "STEEL_TEMPERATURE",
    null as "POWER_ON_TIME",
    null as "ENERGY_TOTAL",
    null AS "SPEC_ENERGY",
    null AS "ACT_TAP_NO",
    null AS "ENERGY_LOSSES",
    (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND C_PLANT_UNIT_ID=7)) AS HEAT_NO_WAITING_P1,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31)  AND C_PLANT_UNIT_ID=7)) AS STEEL_GRADE_WAITING_P1,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31)  AND C_PLANT_UNIT_ID=7) AS LADLE_NO_WAITING_P1,
    (SELECT STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND C_PLANT_UNIT_ID=7)) AS STEEL_TEMPERATURE_WAITING_P1,
    (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32)  AND C_PLANT_UNIT_ID=7)) AS HEAT_NO_WAITING_P2,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND C_PLANT_UNIT_ID=7 )) AS STEEL_GRADE_WAITING_P2,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32)  AND C_PLANT_UNIT_ID=7) AS LADLE_NO_WAITING_P2,
    (SELECT ML_HEAT.STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND C_PLANT_UNIT_ID=7)) AS STEEL_TEMPERATURE_WAITING_P2,
    0 as VOLTAGE_TAP_SETP,
    0 as STIRRING_SETP,
    0 as REMAIN_ENERGY_SETP
  FROM DUAL
  union
  SELECT 0 as "ID",null as AR_CONS, null as AR_FLOW, null as AR_CONS2, null as AR_FLOW2,
    null AS S_HEAT_ID,
    null AS HEAT_ID,
    0 "C_HEAT_STATUS_ID",
    4 "PLANT_UNIT_NO",
    null as "START_TIME",
    null as  "REMAINING_TIME",
    null as "END_TIME",
    null as "CL_PRACTICE_ID",
    null as  "CL_PRACTICE",
    null as "C_PHASE_ID",
    null as C_STEEL_GRADE_ID,
    null as  "STEEL_GRADE",
    null as  "LADLE_ID",
    null as "STEEL_WEIGHT",
    null as "SLAG_WEIGHT",
    null as "STEEL_TEMPERATURE",
    null as "POWER_ON_TIME",
    null as "ENERGY_TOTAL",
    null AS "SPEC_ENERGY",
    null AS "ACT_TAP_NO",
    null AS "ENERGY_LOSSES",
    (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND C_PLANT_UNIT_ID=8)) AS HEAT_NO_WAITING_P1,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31)  AND C_PLANT_UNIT_ID=8)) AS STEEL_GRADE_WAITING_P1,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31)  AND C_PLANT_UNIT_ID=8) AS LADLE_NO_WAITING_P1,
    (SELECT STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(31) AND C_PLANT_UNIT_ID=8)) AS STEEL_TEMPERATURE_WAITING_P1,
    (SELECT HEAT_NO FROM S_HEAT S WHERE S.ID in (SELECT "S_HEAT_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32)  AND C_PLANT_UNIT_ID=8)) AS HEAT_NO_WAITING_P2,
    (SELECT STEEL_GRADE FROM C_STEEL_GRADE cg WHERE cg.ID in (SELECT "C_STEEL_GRADE_ID" FROM PL_HEAT WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND C_PLANT_UNIT_ID=8 )) AS STEEL_GRADE_WAITING_P2,
    (SELECT EQUIPMENT_NAME FROM C_EQUIPMENT CL, PL_HEAT pl  WHERE pl.C_EQUIPMENT_ID_LADLE=CL.ID AND C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32)  AND C_PLANT_UNIT_ID=8) AS LADLE_NO_WAITING_P2,
    (SELECT ML_HEAT.STEEL_TEMPERATURE FROM ML_HEAT WHERE PL_HEAT_ID = (SELECT ID FROM PL_HEAT pl WHERE C_HEAT_STATUS_ID=GET_HEAT_STATUS_ID(32) AND C_PLANT_UNIT_ID=8)) AS STEEL_TEMPERATURE_WAITING_P2,
    0 as VOLTAGE_TAP_SETP,
    0 as STIRRING_SETP,
    0 as REMAIN_ENERGY_SETP
  FROM DUAL;
